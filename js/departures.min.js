function getTrains(){sIDs=[],rows=0,$.get("src/php/getDepartures.php?station="+stationCode+"&rows="+numRows,function(a){for(a.length>0?$.each(a,function(a,b){var c=sanitizeID(b.serviceID);if(rows++,sIDs.push(b.serviceID),0===$("#"+c).length){var d='<div class="departureEntry" id="'+c+'" data-serviceID="'+b.serviceID+'">';if(d+='<div class="departureRow">',d+='<p class="std">',null!=b.std&&(d+=b.std),d+="</p>",d+='<p class="destinationName">',null!=b.destination.location)if(b.destination.location.length>1){var e=0;$.each(b.destination.location,function(a,b){0!=e&&(d+=" &amp; "),d+='<a href="?station='+b.crs+'">'+b.locationName+"</a>",e++})}else d+='<a href="?station='+b.destination.location.crs+'">'+b.destination.location.locationName+"</a>";d+="</p>",d+='<p class="platform">',"train"!=b.serviceType?d+=b.serviceType:null!=b.platform&&(d+=b.platform),d+="</p>",d+='<p class="etd">',null!=b.etd&&(d+=b.etd),d+="</p>",d+="</div>",d+="</div>",$(".departuresList").append(d)}else{var f=$("#"+c),g="";if(null!=b.destination.location)if(g="",b.destination.location.length>1){var e=0;$.each(b.destination.location,function(a,b){0!=e&&(g+=" &amp; "),g+='<a href="?station='+b.crs+'">'+b.locationName+"</a>",e++})}else g+='<a href="?station='+b.destination.location.crs+'">'+b.destination.location.locationName+"</a>";$(f).find(".destinationName").html()!=g.replace(" & "," &amp; ")&&$(f).find(".destinationName").html(g).addClass("departureUpdated"),g="","train"!=b.serviceType?g=b.serviceType:null!=b.platform&&(g=b.platform),$(f).find(".platform").html()!=g&&$(f).find(".platform").html(g).addClass("departureUpdated"),g="",null!=b.etd&&(g=b.etd),$(f).find(".etd").html()!=g&&$(f).find(".etd").html(g)}}):$(".departuresList").append('<div class="departureEntry error"><div class="departureRow"><p class="delayReason">Station not specified or incorrect</p></div></div>'),$.each($(".departureEntry:not(.empty, .error)"),function(a,b){var c=$(b)[0].dataset.serviceid;NaN!=c&&sIDs.indexOf(c)===-1&&(b.remove(),console.log("removed"))}),$(".departureEntry.empty").remove();rows<numRows;)$(".departuresList").append('<div class="departureEntry empty"><div class="departureRow"><p class="delayReason">&nbsp;</p></div></div>'),rows++;for(;rows>numRows;)$(".departureEntry.empty").length>0&&$(".departuresList").find(".departureEntry.empty")[0].remove(),rows--})}var sIDs=[],numRows=27,rows,stationCode=getQueryVariable("station");getTrains(),setInterval(getTrains,1e4);